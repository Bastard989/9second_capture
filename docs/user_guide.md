# User Guide (Local Agent)

Короткая инструкция для пользователя без настройки дизайна.

## Установка
0. Для desktop-сборки (`dist/9second_capture.app`) можно использовать мастер:
   `Исправить в 1 клик` (full STT + Ollama + модель + runtime overrides).
   Во время операции кнопки мастера блокируются до завершения шага.
1. Установи зависимости: `pip install -r requirements.txt`.
2. Установи виртуальный аудио‑драйвер:
   macOS: BlackHole или VB‑Cable.
   Windows: VB‑Cable.
   Linux: PulseAudio/PipeWire с monitor‑источником.
3. Установи Ollama и скачай модель:
   - `brew install --cask ollama`
   - `open -a Ollama`
   - `ollama pull llama3.1:8b`
   Если уже установлен `llama3:8b`, мастер использует его как совместимую модель.

## Запуск
1. Запусти агент: `python3 scripts/run_local_agent.py`.
2. Откроется локальный веб‑интерфейс на `http://127.0.0.1:<порт>`.
3. В блоке `LLM модель` нажми `Сканировать`, выбери нужную модель и нажми `Сменить модель`.
4. В блоке `Запись` выбери профиль качества: `Fast` / `Balanced` / `Accurate`.
5. Выбери профиль языка интервью: `Mixed`, `Русский` или `English`.
6. Нажми `Проверить` в секции диагностики перед `Start`.
7. Если статус `STT: прогрев модели...`, подожди 5-15 секунд и снова нажми `Проверить` (или `Start` — агент подождёт готовность STT перед запуском).

## Проверка захвата
1. Нажми `Check driver` и убедись, что драйвер найден.
2. Выбери режим захвата:
   `System audio` — системный звук через драйвер.
   `Screen + audio` — захват экрана со звуком (fallback).
   Если системный звук экрана недоступен, агент попробует продолжить в режиме mic-only.
3. Нажми `Check capture` и убедись, что индикатор уровня реагирует.
4. Низкие уровни `System/Mic` до начала разговора допустимы и не блокируют запись.
5. Под статусом записи смотри строку `Диагноз`: она объясняет причину плохого распознавания
   (`system track missing`, `mic-only`, `low SNR`, `STT warmup`, `busy device`).

## Запись встречи
1. Нажми `Start` и дождись 9‑секундного отсчёта.
2. Идёт запись. Нажми `Stop`, чтобы остановить.
3. После остановки UI предложит сразу сохранить MP3.

## Отчёт и структурированные данные
1. В разделе результатов выбери нужную запись.
2. Нажми `Generate report (raw/clean)` для создания отчёта.
3. В отчёте смотри сравнимые поля:
   - `overall_score` (1..5),
   - `decision.status` и `decision.confidence`,
   - `scorecard` по 4 критериям (`technical_depth`, `problem_solving`, `communication`, `ownership`),
   - `data_quality.comparable` (можно ли корректно сравнивать с другими интервью).
4. Нажми `Generate structured (raw/clean)` для формирования CSV/JSON по схеме.
5. При необходимости скачай файлы кнопками `Download`.
6. Для аудио используй кнопку `MP3` в блоке результатов.
7. В меню `...` рядом со списком записей можно переименовать запись.

## Загрузка аудио‑файла
1. Выбери файл в `Upload audio`.
2. Нажми `Upload audio`, затем работай с результатами как с обычной записью.

## Quick fallback запись
1. В блоке `Upload` заполни `Meeting URL` и `Duration`.
2. Нажми `Quick start`.
3. При необходимости включи:
   - `Run local transcription`
   - `Upload recording to agent pipeline`
4. Для досрочной остановки нажми `Quick stop`.

## Примечания
1. Все данные остаются локально.
2. Кнопка `Video (in development)` пока недоступна.
3. Для LLM‑отчётов нужно настроить `OPENAI_API_BASE` и `OPENAI_API_KEY` или использовать локальный Ollama.
